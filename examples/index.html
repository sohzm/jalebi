<!doctype html>
<html lang="en">
    <head>
        <title>Jalebi UI Component Library</title>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Comic+Neue:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&family=Creepster&family=Courier+Prime:ital,wght@0,400;0,700;1,400;1,700&family=Fira+Mono:wght@400;500;700&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Lora:ital,wght@0,400..700;1,400..700&family=Satisfy&family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&family=VT323&family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&family=Varela+Round&family=Sarpanch:wght@400;500;600;700;800;900&Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap"
            rel="stylesheet"
        />

        <style>
            :root {
                --bg-1: #ffffff;
                --bg-2: #f7f7f7;
                --bg-3: #e0e0e0;
                --fg-1: #333333;
                --fg-2: #666666;
                --border-1: #cccccc;
                --fg-red: #ff126d;
                --bg-red: #ffebf1;
                --fg-green: #2ecc71;
                --bg-green: #e8f8f1;
                --fg-blue: #487cff;
                --bg-blue: #ebf1ff;
                --fg-yellow: #f1c40f;
                --bg-yellow: #fef9e7;
                --fg-purple: #9b59b6;
                --bg-purple: #f5eef8;
                --fg-cyan: #00bcd4;
                --bg-cyan: #e0f7fa;
                --fg-orange: #e67e22;
                --bg-orange: #fdf2e9;
                --fg-white: #ffffff;
                --bg-white: #ffffff;
                --fg-black: #000000;
                --bg-black: #000000;
                --font: 'Inter', sans-serif;
                --font-cursive: 'Satisfy', cursive;
                --font-heading: 'Inter', sans-serif;
                --font-mono: 'Fira Mono', monospace;
                --radius: 4px;
                --radius-large: 12px;
                --padding-1: 2px;
                --padding-2: 4px;
                --padding-3: 8px;
                --padding-4: 16px;
                --padding-w1: 4px 8px;
                --padding-w2: 8px 16px;
                --padding-w3: 10px 20px;
                --gap-1: 5px;
                --gap-2: 10px;
                --gap-3: 20px;
                --drop-shadow: drop-shadow(0 0 20px rgba(0, 0, 0, 0.1));
                --accent-svg: brightness(0) saturate(100%) invert(27%) sepia(51%) saturate(4354%) hue-rotate(242deg) brightness(92%) contrast(93%);
                --fg-accent: #5c35d9;
                --bg-accent: #f2eeff;
                --themed-svg: none;
            }
            code {
                font-family: var(--font-mono);
                background-color: var(--bg-3);
                padding: var(--padding-1);
                border-radius: var(--radius);
            }
            @media (hover: hover) {
                *::-webkit-scrollbar {
                    width: 15px;
                }
                *::-webkit-scrollbar-track {
                    background: var(--bg-1);
                }
                *::-webkit-scrollbar-thumb {
                    background-color: var(--bg-3);
                    border-radius: 20px;
                    border: 4px solid var(--bg-1);
                }
                *::-webkit-scrollbar-thumb:hover {
                    background-color: var(--fg-1);
                }
            }
            * {
                box-sizing: border-box;
            }
            body,
            html {
                margin: 0;
                padding: 0;
                height: 100%;
                font-family: var(--font);
                background-color: var(--bg-1);
                color: var(--fg-1);
            }
            body {
                max-width: 1400px;
                margin: 0 auto;
            }
            p {
                margin: 0;
            }
            pre {
                font-family: var(--font-mono);
                background-color: var(--bg-3);
                padding: var(--padding-3);
                border-radius: var(--radius);
                overflow-x: auto;
            }
            a {
                color: var(--fg-blue);
            }
            select {
                padding: var(--padding-2);
                border-radius: var(--radius);
                border: 1px solid var(--border-1);
                background-color: var(--bg-2);
                color: var(--fg-1);
                outline: none;
            }
            button {
            }
            button:hover {
            }

            /* Layout styling */
            .app-container {
                display: flex;
                height: 100vh;
            }

            /* Header */
            .header {
                display: flex;
                align-items: center;
                padding: var(--padding-4);
                background-color: var(--bg-1);
                height: 70px;
            }

            .logo-container {
                display: flex;
                align-items: center;
                justify-content: space-between;
                gap: var(--gap-2);
            }

            .logo-container img {
                max-height: 40px;
            }

            .theme-selector {
                margin-left: auto;
                display: flex;
                align-items: center;
                gap: var(--gap-2);
            }

            /* Sidebar */
            .sidebar {
                width: 250px;
                flex-shrink: 0;
                display: flex;
                flex-direction: column;
                height: 100%;
                overflow-y: auto;
            }

            .sidebar-header {
                padding: var(--padding-4);
                height: 70px;
            }

            .sidebar-content {
                flex-grow: 1;
                overflow-y: auto;
                padding: var(--padding-3);
            }

            .component-nav ul {
                list-style-type: none;
                padding: 0;
                margin: 0;
            }

            .component-nav li {
                margin-bottom: var(--gap-1);
            }

            .component-nav a {
                display: block;
                padding: var(--padding-w1);
                border-radius: var(--radius);
                transition: background-color 0.2s;
                color: var(--fg-1);
                text-decoration: none;
            }

            .component-nav a:hover {
                background-color: var(--bg-3);
            }

            .component-nav a.active {
                background-color: var(--fg-1);
                color: var(--bg-1);
                font-weight: 500;
            }

            /* Main content */
            .main-content {
                flex-grow: 1;
                display: flex;
                flex-direction: column;
                height: 100%;
                overflow: hidden;
            }

            .content-container {
                flex-grow: 1;
                overflow-y: auto;
                padding: var(--padding-4);
            }

            .component-display {
                padding: var(--padding-4);
                background-color: var(--bg-1);
                border-radius: var(--radius-large);
                margin-bottom: var(--gap-3);
                min-height: 150px;
                border: 1px solid var(--border-1);
                display: flex;
                align-items: center;
                justify-content: center;
                flex-direction: column;
                gap: 20px;
            }

            .component-section {
                display: none;
            }

            .component-section.active {
                display: block;
            }

            .component-description {
                margin-bottom: var(--gap-3);
                line-height: 1.5;
            }

            .component-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: var(--gap-3);
            }

            .component-header h2 {
                margin: 0;
            }

            @media (max-width: 768px) {
                .app-container {
                    flex-direction: column;
                }
                .sidebar {
                    width: 100%;
                    height: 100%;
                    border-right: none;
                    border-bottom: 1px solid var(--border-1);
                }
                .sidebar-content {
                    overflow-y: auto;
                }
                .main-content {
                    height: auto;
                }
            }

            /* Mobile menu button */
            .mobile-menu-toggle {
                display: none;
                background: none;
                border: none;
                cursor: pointer;
                padding: var(--padding-2);
                border-radius: var(--radius);
            }

            .mobile-menu-toggle:hover {
                background-color: var(--bg-2);
            }

            /* Responsive styles */
            @media (max-width: 900px) {
                .app-container {
                    flex-direction: column;
                }

                .mobile-menu-toggle {
                    display: flex;
                }

                .sidebar {
                    width: 100%;
                    position: fixed;
                    top: 0;
                    left: 0;
                    z-index: 1000;
                    background-color: var(--bg-1);
                    transform: translateY(-100%);
                    transition: transform 0.3s ease;
                    border-bottom: 1px solid var(--border-1);
                    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                }

                .sidebar.mobile-visible {
                    transform: translateY(0);
                }

                .main-content {
                    width: 100%;
                }
            }
        </style>
    </head>
    <body>
        <div class="app-container">
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <div class="logo-container">
                        <img src="/assets/jalebi.svg" class="logooo" alt="Jalebi" draggable="false" style="filter: var(--themed-svg)" />

                        <button id="mobile-menu-toggle2" class="mobile-menu-toggle" aria-label="Toggle menu">
                            <svg
                                width="24px"
                                height="24px"
                                stroke-width="2"
                                viewBox="0 0 24 24"
                                fill="none"
                                xmlns="http://www.w3.org/2000/svg"
                                color="var(--fg-1)"
                            >
                                <path
                                    d="M3 5h18M3 12h18M3 19h18"
                                    stroke="var(--fg-1)"
                                    stroke-width="2"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                ></path>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="sidebar-content">
                    <nav class="component-nav" id="component-nav">
                        <div class="theme-selector">
                            <jalebi-select style="margin-bottom: var(--padding-4)" search id="themes"></jalebi-select>
                        </div>

                        <!-- Navigation will be populated dynamically -->
                    </nav>
                </div>
            </aside>

            <!-- Main content -->
            <main class="main-content">
                <header class="header">
                    <jalebi-breadcrumbs style="width: 100%" id="current-component">Loading...</jalebi-breadcrumbs>
                    <button id="mobile-menu-toggle" class="mobile-menu-toggle" aria-label="Toggle menu">
                        <svg
                            width="24px"
                            height="24px"
                            stroke-width="2"
                            viewBox="0 0 24 24"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                            color="var(--fg-1)"
                        >
                            <path
                                d="M3 5h18M3 12h18M3 19h18"
                                stroke="var(--fg-1)"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            ></path>
                        </svg>
                    </button>
                </header>

                <div class="content-container" id="component-content">
                    <!-- Component sections will be populated dynamically -->
                </div>
            </main>
        </div>

        <!-- Scripts -->

        <script src="/src/themes/themes.js"></script>
        <script>
            // Fetch and load component data
            let componentsData = null;
            let currentComponent = null;

            // Function to get URL parameter
            function getUrlParam(param) {
                const urlParams = new URLSearchParams(window.location.search);
                return urlParams.get(param);
            }

            // Function to set URL parameter
            function setUrlParam(param, value) {
                const url = new URL(window.location.href);
                url.searchParams.set(param, value);
                window.history.pushState({}, '', url);
            }

            // Load component data from JSON
            async function loadComponentData() {
                try {
                    const response = await fetch('/examples/elements.json');
                    componentsData = await response.json();

                    // Initialize the UI
                    populateSidebar();

                    // Load the component specified in URL or default to introduction
                    const elementParam = getUrlParam('element') || 'introduction';
                    loadComponent(elementParam);

                    // Load component scripts
                    loadComponentScripts();
                } catch (error) {
                    console.error('Error loading component data:', error);
                }
            }

            // Populate sidebar navigation
            function populateSidebar() {
                const navContainer = document.getElementById('component-nav');
                const navList = document.createElement('ul');

                componentsData.components.forEach(component => {
                    const listItem = document.createElement('li');
                    const link = document.createElement('a');

                    link.href = `?element=${component.id}`;
                    link.textContent = component.name;
                    link.className = 'nav-link';
                    link.setAttribute('data-component', component.id);

                    link.addEventListener('click', function (e) {
                        e.preventDefault();
                        loadComponent(component.id);
                        setUrlParam('element', component.id);
                    });

                    listItem.appendChild(link);
                    navList.appendChild(listItem);
                });

                navContainer.appendChild(navList);
            }

            // Load a specific component
            function loadComponent(componentId) {
                // Find the component data
                currentComponent = componentsData.components.find(comp => comp.id === componentId);
                if (!currentComponent) {
                    console.error(`Component with ID '${componentId}' not found.`);
                    return;
                }

                // Update active navigation link
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('data-component') === componentId) {
                        link.classList.add('active');
                    }
                });

                // Update header title
                document
                    .getElementById('current-component')
                    .setAttribute('data-breadcrumb', 'Jalebi:/examples,' + currentComponent.name + ':/examples?element=' + componentId);

                // Clear and update content container
                const contentContainer = document.getElementById('component-content');
                contentContainer.innerHTML = '';

                // Create component section
                const section = document.createElement('section');
                section.id = `${componentId}-section`;
                section.className = 'component-section active';

                // Add component header
                const header = document.createElement('div');
                header.className = 'component-header';
                header.innerHTML = `<h2>${currentComponent.name}</h2>`;
                section.appendChild(header);

                // link to github src of that component
                const githubLink = document.createElement('a');
                githubLink.href = 'https://github.com/sohzm/jalebi/blob/master/src/jalebi-' + currentComponent.id + '.js';
                githubLink.target = '_blank';
                githubLink.textContent = 'Source';
                githubLink.style.fontSize = '14px';
                header.appendChild(githubLink);

                // Add component description
                const description = document.createElement('div');
                description.className = 'component-description';
                description.innerHTML = currentComponent.description;
                section.appendChild(description);

                // Add component examples
                if (currentComponent.examples && currentComponent.examples.length > 0) {
                    // Display all examples first
                    currentComponent.examples.forEach(example => {
                        const display = document.createElement('div');
                        display.className = 'component-display';
                        display.innerHTML = example.html;
                        section.appendChild(display);
                    });

                    // Then add the code block after all examples
                    if (currentComponent.code) {
                        const codeDisplay = document.createElement('div');
                        codeDisplay.className = 'component-code';
                        codeDisplay.innerHTML = `<pre>${escapeHtml(currentComponent.code)}</pre>`;
                        section.appendChild(codeDisplay);
                    }
                }

                contentContainer.appendChild(section);
            }

            // Escape HTML for code display
            function escapeHtml(html) {
                const div = document.createElement('div');
                div.textContent = html;
                return div.innerHTML;
            }

            // Load component scripts
            function loadComponentScripts() {
                if (componentsData.scripts && componentsData.scripts.length > 0) {
                    console.log(componentsData);
                    componentsData.scripts.forEach(scriptPath => {
                        const script = document.createElement('script');
                        script.src = scriptPath;
                        document.body.appendChild(script);
                    });
                }
            }

            function initializeThemeSelector() {
                const themesSelect = document.getElementById('themes');

                // Wait for themes to be loaded
                jalebi.theme.onReady(function (themes) {
                    // Populate the dropdown
                    themes.forEach(theme => {
                        const option = document.createElement('option');
                        option.value = theme.name;
                        option.textContent = theme.name;
                        themesSelect.appendChild(option);
                    });

                    // Set current theme as selected
                    const currentTheme = jalebi.theme.currentTheme();
                    if (currentTheme) {
                        themesSelect.value = currentTheme;
                    }

                    // Add change handler
                    themesSelect.addEventListener('change', function (e) {
                        jalebi.theme.setTheme(e.target.value);
                    });
                });
            }

            // Initialize the application
            document.addEventListener('DOMContentLoaded', function () {
                loadComponentData();
                initializeThemeSelector();
            });
        </script>

        <script>
            // Function to initialize search functionality
            function initializeSearch() {
                // First, create and insert the search button element
                const searchButton = document.createElement('button');
                searchButton.id = 'search-button';
                searchButton.className = 'search-button';
                searchButton.setAttribute('aria-label', 'Search components');
                searchButton.innerHTML = `
            <svg width="24px" height="24px" stroke-width="2" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" color="var(--fg-1)" style="pointer-events: none;">
                <path d="M15.5 15.5L19 19" stroke="var(--fg-1)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                <path d="M5 11a6 6 0 1012 0 6 6 0 00-12 0z" stroke="var(--fg-1)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        `;

                // Create the search dialog
                const searchDialog = document.createElement('div');
                searchDialog.id = 'search-dialog';
                searchDialog.className = 'search-dialog';
                searchDialog.innerHTML = `
            <div class="search-dialog-header">
                <div class="search-input-container">
                    <input type="text" id="search-input" placeholder="Search components..." autofocus>
                    <button id="clear-search" class="clear-search-button" aria-label="Clear search">
                        <svg width="16px" height="16px" stroke-width="2" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" color="var(--fg-1)">
                            <path d="M6.75827 17.2426L12.0009 12M17.2435 6.75736L12.0009 12M12.0009 12L6.75827 6.75736M12.0009 12L17.2435 17.2426" stroke="var(--fg-1)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                        </svg>
                    </button>
                </div>
                <button id="close-search" class="close-search-button" aria-label="Close search">
                    <svg width="20px" height="20px" stroke-width="2" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" color="var(--fg-1)">
                        <path d="M6.75827 17.2426L12.0009 12M17.2435 6.75736L12.0009 12M12.0009 12L6.75827 6.75736M12.0009 12L17.2435 17.2426" stroke="var(--fg-1)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                    </svg>
                </button>
            </div>
            <div class="search-results" id="search-results">
                <!-- Search results will be populated here -->
            </div>
        `;

                // Create a container for the search elements
                const searchContainer = document.createElement('div');
                searchContainer.className = 'search-container';
                searchContainer.appendChild(searchButton);
                searchContainer.appendChild(searchDialog);

                // Insert the search container before the GitHub link in the header
                const logoContainer = document.querySelector('.header');
                const mobileMenuToggle2 = document.getElementById('mobile-menu-toggle');

                logoContainer.insertBefore(searchContainer, mobileMenuToggle2);

                // Add styles for search elements
                const styleElement = document.createElement('style');
                styleElement.textContent = `
            /* Search container and button styles */
            .search-container {
                margin-left: 10px;
            }
            
            .search-button {
                background: none;
                border: none;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 4px;
                border-radius: var(--radius);
                transition: background-color 0.2s;
            }
            
            .search-button:hover {
                background-color: var(--bg-2);
            }
            
            /* Search dialog styles */
            .search-dialog {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 90%;
                max-width: 500px;
                max-height: 500px;
                background-color: var(--bg-1);
                border: 1px solid var(--border-1);
                border-radius: var(--radius-large);
                z-index: 1000;
                display: none;
                flex-direction: column;
                overflow: hidden;
                filter: var(--drop-shadow);
                transition: all 0.3s ease-in-out;
                opacity: 1;
            }

            @starting-style {
                .search-dialog {
                    opacity: 0;
                    top: 60%;
                }
            }
            
            .search-dialog.active {
                display: flex;
            }
            
            .search-dialog-header {
                display: flex;
                align-items: center;
                padding: var(--padding-w3);
            }
            
            .search-input-container {
                position: relative;
                flex: 1;
                display: flex;
                align-items: center;
            }
            
            #search-input {
                width: 100%;
                padding: var(--padding-w1);
                border: 1px solid var(--border-1);
                border-radius: var(--radius);
                outline: none;
                font-family: var(--font);
                color: var(--fg-1);
                background-color: var(--bg-2);
            }
            
            #search-input:focus {
                border-color: var(--fg-accent);
            }
            
            .clear-search-button {
                background: none;
                border: none;
                cursor: pointer;
                position: absolute;
                right: 8px;
                display: none;
                padding: 0;
            }
            
            .clear-search-button.visible {
                display: block;
            }
            
            .close-search-button {
                background: none;
                border: none;
                cursor: pointer;
                margin-left: var(--padding-2);
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 4px;
                border-radius: 50%;
            }
            
            .close-search-button:hover {
                background-color: var(--bg-2);
            }
            
            /* Search results styles */
            .search-results {
                flex: 1;
                overflow-y: auto;
                padding: var(--padding-2);
            }
            
            .search-result-item {
                padding: var(--padding-w2);
                border-radius: var(--radius);
                cursor: pointer;
                margin-bottom: var(--padding-1);
                transition: background-color 0.2s;
            }
            
            .search-result-item:hover {
                background-color: var(--bg-2);
            }
            
            .search-result-item h3 {
                margin: 0 0 var(--padding-2) 0;
                font-size: 16px;
            }
            
            .search-result-item p {
                margin: 0;
                font-size: 14px;
                color: var(--fg-2);
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }
            
            .no-results {
                padding: var(--padding-w2);
                text-align: center;
                color: var(--fg-2);
            }
            
        `;
                document.head.appendChild(styleElement);

                // Add event listeners for search functionality
                const searchInput = document.getElementById('search-input');
                const searchResults = document.getElementById('search-results');
                const closeSearch = document.getElementById('close-search');
                const clearSearch = document.getElementById('clear-search');

                // Show search dialog when search button is clicked
                searchButton.addEventListener('click', () => {
                    searchDialog.classList.add('active');
                    searchInput.focus();

                    // Set initial search results (show all components)
                    displaySearchResults(componentsData.components);
                });

                // Close search dialog
                closeSearch.addEventListener('click', () => {
                    searchDialog.classList.remove('active');
                    searchInput.value = '';
                    clearSearch.classList.remove('visible');
                });

                // Clear search input
                clearSearch.addEventListener('click', () => {
                    searchInput.value = '';
                    searchInput.focus();
                    clearSearch.classList.remove('visible');
                    displaySearchResults(componentsData.components);
                });

                // Search as user types
                searchInput.addEventListener('input', e => {
                    const searchTerm = e.target.value.toLowerCase().trim();

                    // Show/hide clear button based on input content
                    if (searchTerm.length > 0) {
                        clearSearch.classList.add('visible');
                    } else {
                        clearSearch.classList.remove('visible');
                    }

                    if (searchTerm === '') {
                        // If empty, show all components
                        displaySearchResults(componentsData.components);
                    } else {
                        // Filter components based on search term
                        const filteredComponents = componentsData.components.filter(component => {
                            const nameMatch = component.name.toLowerCase().includes(searchTerm);
                            const descMatch = component.description.toLowerCase().includes(searchTerm);
                            return nameMatch || descMatch;
                        });

                        displaySearchResults(filteredComponents);
                    }
                });

                // Close dialog when clicking outside
                document.addEventListener('click', e => {
                    if (searchDialog.classList.contains('active') && !searchDialog.contains(e.target) && e.target !== searchButton) {
                        searchDialog.classList.remove('active');
                        searchInput.value = '';
                        clearSearch.classList.remove('visible');
                    }
                });

                // Prevent clicks inside dialog from closing it
                searchDialog.addEventListener('click', e => {
                    e.stopPropagation();
                });

                // Handle keyboard events
                document.addEventListener('keydown', e => {
                    // Close dialog on Escape key
                    if (e.key === 'Escape' && searchDialog.classList.contains('active')) {
                        searchDialog.classList.remove('active');
                        searchInput.value = '';
                        clearSearch.classList.remove('visible');
                    }

                    // Open dialog on Ctrl+K or Command+K
                    if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                        e.preventDefault();
                        searchDialog.classList.contains('active') ? searchDialog.classList.remove('active') : searchDialog.classList.add('active');

                        if (searchDialog.classList.contains('active')) {
                            searchInput.focus();
                            displaySearchResults(componentsData.components);
                        }
                    }
                });
            }

            // Display search results
            function displaySearchResults(components) {
                const searchResults = document.getElementById('search-results');
                searchResults.innerHTML = '';

                if (components.length === 0) {
                    searchResults.innerHTML = '<div class="no-results">No components found</div>';
                    return;
                }

                components.forEach(component => {
                    const resultItem = document.createElement('div');
                    resultItem.className = 'search-result-item';

                    // Strip HTML tags for description preview
                    const tempDiv = document.createElement('div');
                    tempDiv.innerHTML = component.description;
                    const descText = tempDiv.textContent || tempDiv.innerText || '';

                    resultItem.innerHTML = `
                <h3>${component.name}</h3>
                <p>${descText.substring(0, 100)}${descText.length > 100 ? '...' : ''}</p>
            `;

                    // Navigate to component when clicked
                    resultItem.addEventListener('click', () => {
                        loadComponent(component.id);
                        setUrlParam('element', component.id);

                        // Close the search dialog
                        document.getElementById('search-dialog').classList.remove('active');
                        document.getElementById('search-input').value = '';
                        document.getElementById('clear-search').classList.remove('visible');
                    });

                    searchResults.appendChild(resultItem);
                });
            }

            // Initialize search when components data is loaded
            function initializeWhenReady() {
                if (typeof componentsData !== 'undefined' && componentsData) {
                    initializeSearch();
                } else {
                    // Check again after a short delay
                    setTimeout(initializeWhenReady, 100);
                }
            }

            // Start initialization
            document.addEventListener('DOMContentLoaded', initializeWhenReady);

            // If DOMContentLoaded already fired, initialize now
            if (document.readyState === 'complete' || document.readyState === 'interactive') {
                initializeWhenReady();
            }

            document.addEventListener('DOMContentLoaded', function () {
                const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
                const sidebar = document.querySelector('.sidebar');

                if (mobileMenuToggle && sidebar) {
                    mobileMenuToggle.addEventListener('click', function () {
                        sidebar.classList.toggle('mobile-visible');
                    });

                    // Close sidebar when clicking on a component link
                    const navLinks = document.querySelectorAll('.nav-link');
                    navLinks.forEach(link => {
                        link.addEventListener('click', function () {
                            if (window.innerWidth <= 900) {
                                sidebar.classList.remove('mobile-visible');
                            }
                        });
                    });

                    // Close sidebar when clicking outside
                    document.addEventListener('click', function (event) {
                        if (
                            window.innerWidth <= 900 &&
                            !sidebar.contains(event.target) &&
                            event.target !== mobileMenuToggle &&
                            !mobileMenuToggle.contains(event.target)
                        ) {
                            sidebar.classList.remove('mobile-visible');
                        }
                    });
                }

                const mobileMenuToggle2 = document.getElementById('mobile-menu-toggle2');

                if (mobileMenuToggle2 && sidebar) {
                    mobileMenuToggle2.addEventListener('click', function () {
                        sidebar.classList.toggle('mobile-visible');
                    });

                    // Close sidebar when clicking on a component link
                    const navLinks = document.querySelectorAll('.nav-link');
                    navLinks.forEach(link => {
                        link.addEventListener('click', function () {
                            if (window.innerWidth <= 900) {
                                sidebar.classList.remove('mobile-visible');
                            }
                        });
                    });

                    // Close sidebar when clicking outside
                    document.addEventListener('click', function (event) {
                        if (
                            window.innerWidth <= 900 &&
                            !sidebar.contains(event.target) &&
                            event.target !== mobileMenuToggle &&
                            !mobileMenuToggle.contains(event.target)
                        ) {
                            sidebar.classList.remove('mobile-visible');
                        }
                    });
                }
            });
        </script>
    </body>
</html>
